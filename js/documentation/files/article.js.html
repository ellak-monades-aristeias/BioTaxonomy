<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>article.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/$(document).on().html">$(document).on()</a></li>
                                <li><a href="../classes/ajaxError.html">ajaxError</a></li>
                                <li><a href="../classes/articleExistsQuery.html">articleExistsQuery</a></li>
                                <li><a href="../classes/articleRankSuccess.html">articleRankSuccess</a></li>
                                <li><a href="../classes/capitalizeFirstLetter.html">capitalizeFirstLetter</a></li>
                                <li><a href="../classes/ChangeDiv.html">ChangeDiv</a></li>
                                <li><a href="../classes/changeLanguage.html">changeLanguage</a></li>
                                <li><a href="../classes/checkUrl.html">checkUrl</a></li>
                                <li><a href="../classes/clearNextRanks.html">clearNextRanks</a></li>
                                <li><a href="../classes/divsForMobile.html">divsForMobile</a></li>
                                <li><a href="../classes/executeOpenQuery.html">executeOpenQuery</a></li>
                                <li><a href="../classes/getArticle.html">getArticle</a></li>
                                <li><a href="../classes/getCurrPage.html">getCurrPage</a></li>
                                <li><a href="../classes/getGreekName.html">getGreekName</a></li>
                                <li><a href="../classes/getImportantQuery.html">getImportantQuery</a></li>
                                <li><a href="../classes/getLanguageResources.html">getLanguageResources</a></li>
                                <li><a href="../classes/getMembers.html">getMembers</a></li>
                                <li><a href="../classes/getName.html">getName</a></li>
                                <li><a href="../classes/getNextRank.html">getNextRank</a></li>
                                <li><a href="../classes/getOpenQuery.html">getOpenQuery</a></li>
                                <li><a href="../classes/getPluralRank.html">getPluralRank</a></li>
                                <li><a href="../classes/getPrevRank.html">getPrevRank</a></li>
                                <li><a href="../classes/getprevRankNameQuery.html">getprevRankNameQuery</a></li>
                                <li><a href="../classes/getSearchQuery.html">getSearchQuery</a></li>
                                <li><a href="../classes/getSearchRank.html">getSearchRank</a></li>
                                <li><a href="../classes/getSearchRankQuery.html">getSearchRankQuery</a></li>
                                <li><a href="../classes/getStatistics.html">getStatistics</a></li>
                                <li><a href="../classes/getSummaryQuery.html">getSummaryQuery</a></li>
                                <li><a href="../classes/getThumbUrl.html">getThumbUrl</a></li>
                                <li><a href="../classes/getTotalQuery.html">getTotalQuery</a></li>
                                <li><a href="../classes/goBack.html">goBack</a></li>
                                <li><a href="../classes/greekNameSuccess.html">greekNameSuccess</a></li>
                                <li><a href="../classes/greekSuccess.html">greekSuccess</a></li>
                                <li><a href="../classes/hideShowDivs.html">hideShowDivs</a></li>
                                <li><a href="../classes/importantMembersSuccess.html">importantMembersSuccess</a></li>
                                <li><a href="../classes/loadArticle.html">loadArticle</a></li>
                                <li><a href="../classes/membersSuccess.html">membersSuccess</a></li>
                                <li><a href="../classes/nameFromUrl.html">nameFromUrl</a></li>
                                <li><a href="../classes/normalDivs.html">normalDivs</a></li>
                                <li><a href="../classes/openSuccess.html">openSuccess</a></li>
                                <li><a href="../classes/prettyLoadRank.html">prettyLoadRank</a></li>
                                <li><a href="../classes/prevRankSuccess.html">prevRankSuccess</a></li>
                                <li><a href="../classes/randomColorGenerator.html">randomColorGenerator</a></li>
                                <li><a href="../classes/returnGreekNameQuery.html">returnGreekNameQuery</a></li>
                                <li><a href="../classes/returnOneEnglishNameQuery.html">returnOneEnglishNameQuery</a></li>
                                <li><a href="../classes/saveTree.html">saveTree</a></li>
                                <li><a href="../classes/searchArticle.html">searchArticle</a></li>
                                <li><a href="../classes/searchSuccess.html">searchSuccess</a></li>
                                <li><a href="../classes/searchTree.html">searchTree</a></li>
                                <li><a href="../classes/shadeColor2.html">shadeColor2</a></li>
                                <li><a href="../classes/showAbout.html">showAbout</a></li>
                                <li><a href="../classes/showAllDivs.html">showAllDivs</a></li>
                                <li><a href="../classes/showArticle.html">showArticle</a></li>
                                <li><a href="../classes/showIndex.html">showIndex</a></li>
                                <li><a href="../classes/shrinkImg200.html">shrinkImg200</a></li>
                                <li><a href="../classes/shrinkImg300.html">shrinkImg300</a></li>
                                <li><a href="../classes/startLoading.html">startLoading</a></li>
                                <li><a href="../classes/stopLoading.html">stopLoading</a></li>
                                <li><a href="../classes/summarySuccess.html">summarySuccess</a></li>
                                <li><a href="../classes/thumbHtml.html">thumbHtml</a></li>
                                <li><a href="../classes/totalQuerySuccess.html">totalQuerySuccess</a></li>
                                <li><a href="../classes/treeToGreek.html">treeToGreek</a></li>
                            </ul>
                
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/Article.html">Article</a></li>
                                <li><a href="../modules/Languages.html">Languages</a></li>
                                <li><a href="../modules/Navigation.html">Navigation</a></li>
                                <li><a href="../modules/Queries.html">Queries</a></li>
                                <li><a href="../modules/Tree.html">Tree</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: article.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
  /**
 * Functions for article page. 
 *
 * @module Article
 */
 
 /**
* Generates a random color
*
* @class randomColorGenerator
* @constructor
*/

  
  var randomColorGenerator = function() {
      return &#x27;#&#x27; + (Math.random().toString(16) + &#x27;0000000&#x27;).slice(2, 8);
  };
 /**
* Generates a color shade
*
* @class shadeColor2
* @constructor
* @param {string} color Color
* @param {number} percent Precentage
*/
  function shadeColor2(color, percent) {
      var f = parseInt(color.slice(1), 16),
          t = percent &lt; 0 ? 0 : 255,
          p = percent &lt; 0 ? percent * -1 : percent,
          R = f &gt;&gt; 16,
          G = f &gt;&gt; 8 &amp; 0x00FF,
          B = f &amp; 0x0000FF;
      return &quot;#&quot; + (0x1000000 + (Math.round((t - R) * p) + R) * 0x10000 + (
          Math.round((t - G) * p) + G) * 0x100 + (Math.round((t - B) *
          p) + B)).toString(16).slice(1);
  }
 /**
* Callback for getStatistics. Creates pie chart with help of chart.js
*
* @class totalQuerySuccess
* @constructor
* @param {object} _data Ajax response that contains total number of species
*/
  function totalQuerySuccess(_data) {
    var totalCount = 0;
    var data = [];
    var dbpedia_results = _data.results.bindings;
    for (var j in dbpedia_results) {
        var name = nameFromUrl(dbpedia_results[j].order.value);
        var count = dbpedia_results[j].count.value;
        totalCount = totalCount + parseInt(count);
        name = name.replace(&quot;_&quot;, &#x27; &#x27;);
        if (name == sessionStorage.getItem(&#x27;name&#x27;)) {
            var currRanking = parseInt(j) + 1;
            var currCount = count;
        }
        data.push({
            value: count,
            color: randomColorGenerator(),
            highlight: randomColorGenerator(),
            label: &#x27;#&#x27; + (parseInt(j) + 1) + &#x27;:&#x27; + name
        });
    }
    var total = parseInt(j) + 1;
    $(&#x27;#totalNumber&#x27;).html(getArticle(getPrevRank(sessionStorage.getItem(&#x27;rank&#x27;))) + &#x27;&lt;span name=&quot;lbl&quot; caption=&quot;&#x27; +
        getPrevRank(sessionStorage.getItem(&#x27;rank&#x27;)) + &#x27;&quot;&gt;&lt;/span&gt; &#x27; +
        &#x27;&lt;b&gt;&lt;a href=&quot;javascript:showArticle();&quot;&gt; &lt;span id=&quot;statPrevRank&quot; caption=&quot;&#x27; + sessionStorage.getItem(
            &#x27;prevRankName&#x27;) + &#x27;&quot;&gt;&lt;/span&gt;&#x27; +


        &#x27;&lt;/a&gt;&lt;/b&gt; &lt;span name=&quot;lbl&quot; caption=&quot;has&quot;&gt;&lt;/span&gt; &lt;b&gt;&#x27; + total +
        &#x27; &#x27; + getPluralRank() +
        &#x27;&lt;/b&gt; &lt;span name=&quot;lbl&quot; caption=&quot;withTotal&quot;&gt;&lt;/span&gt; &lt;b&gt;&#x27; +
        totalCount + &#x27;&lt;/b&gt; &lt;span name=&quot;lbl&quot; caption=&quot;members&quot;&gt;&lt;/span&gt;&#x27;);
    $(&#x27;#current&#x27;).html(getArticle(sessionStorage.getItem(&#x27;rank&#x27;)) + &#x27;&lt;span name=&quot;lbl&quot; caption=&quot;&#x27; +
        sessionStorage.getItem(&#x27;rank&#x27;) + &#x27;&quot;&gt;&lt;/span&gt;&lt;b&gt;&lt;p id=&quot;statName&quot; caption=&quot;&#x27; + sessionStorage.getItem(&#x27;name&#x27;) + &#x27;&quot;&gt;&#x27; + sessionStorage.getItem(&#x27;name&#x27;) + &#x27;&lt;/p&gt;&#x27; +
        &#x27;&lt;/b&gt; &lt;span name=&quot;lbl&quot; caption=&quot;is&quot;&gt;&lt;/span&gt; &lt;b&gt;#&#x27; + currRanking + &#x27;&lt;/b&gt; &lt;span name=&quot;lbl&quot; caption=&quot;with&quot;&gt;&lt;/span&gt; &lt;b&gt;&#x27; + currCount +
        &#x27;&lt;/b&gt; &lt;span name=&quot;lbl&quot; caption=&quot;members&quot;&gt;&lt;/span&gt; &#x27;);
    var ctx = $(&quot;#myChart&quot;).get(0).getContext(&quot;2d&quot;);
    // This will get the first returned node in the jQuery collection.
    var myPieChart = new Chart(ctx).Pie(data, {
        segmentShowStroke: false
    });
    changeLanguage(sessionStorage.getItem(&#x27;lang&#x27;));
}
  
   /**
* Makes ajax request for statistics. 
*
* @class getStatistics
* @constructor
*/
  function getStatistics(){
  var prevRankName = sessionStorage.getItem(&#x27;prevRankName&#x27;);
  var rank = sessionStorage.getItem(&#x27;rank&#x27;);
  var prevRank = getPrevRank(rank);
  query = getTotalQuery(prevRank, prevRankName, rank);
  var queryUrl = encodeURI(url + &quot;?query=&quot; + query + &quot;&amp;format=json&quot;);
  checkUrl();
  $.ajax({
      dataType: &quot;jsonp&quot;,
      url: queryUrl,
      success: totalQuerySuccess,
      error: ajaxError
  });
  }
  
   /**
* Gets plural form of rank. Used in statistics message. 
*
* @class getPluralRank
* @constructor
* @param {string} rank Rank
*/
  function getPluralRank(rank) {
      return &#x27;&lt;span name=&quot;lbl&quot; caption=&quot;&#x27; + sessionStorage.getItem(&#x27;rank&#x27;) +
          &#x27;Plural&quot;&gt;&lt;/span&gt;&#x27;;
  }
   /**
* Gets article used before rank. Used for greek translation. 
*
* @class getArticle
* @constructor
* @param {string} rank Rank
*/
  function getArticle(rank) {
      
      if (rank == &#x27;kingdom&#x27; || rank == &#x27;genus&#x27; || rank == &#x27;species&#x27;) {
          return &#x27;&lt;span name=&quot;lbl&quot; caption=&quot;articleTo&quot;&gt;&lt;/span&gt; &#x27;;
      } else {
          return &#x27;&lt;span name=&quot;lbl&quot; caption=&quot;articleH&quot;&gt;&lt;/span&gt; &#x27;;
      }
  }
    /**
* Inserts article into DOM. 
*
* @class loadArticle
* @constructor
*/
  function loadArticle() {
    if (sessionStorage.getItem(&#x27;name&#x27;) !== undefined) {
        if (sessionStorage.getItem(&#x27;lang&#x27;) == &#x27;gr&#x27; &amp;&amp; sessionStorage.getItem(
            &#x27;name&#x27;) != sessionStorage.getItem(&#x27;greekName&#x27;)) {
            $(&#x27;#title&#x27;).html(sessionStorage.getItem(&#x27;greekName&#x27;));
            $(&#x27;#wikiLink&#x27;).attr(&#x27;href&#x27;, &#x27;https://el.wikipedia.org/wiki/&#x27; +
                (sessionStorage.getItem(&#x27;greekName&#x27;)).replace(&#x27; &#x27;, &#x27;_&#x27;)
            );
            $(&#x27;#article&#x27;).wikiblurb({
                wikiURL: &quot;http://el.wikipedia.org/&quot;,
                section: 0,
                page: sessionStorage.getItem(&#x27;greekName&#x27;),
            });
        } else {
            $(&#x27;#title&#x27;).html(sessionStorage.getItem(&#x27;name&#x27;));
            $(&#x27;#wikiLink&#x27;).attr(&#x27;href&#x27;, &#x27;https://en.wikipedia.org/wiki/&#x27; +
                (sessionStorage.getItem(&#x27;name&#x27;)).replace(&#x27; &#x27;, &#x27;_&#x27;));
            $(&#x27;#article&#x27;).wikiblurb({
                section: 0,
                page: sessionStorage.getItem(&#x27;name&#x27;),
            });
        }
    } else {
        $(&#x27;#article&#x27;).html(&quot;No article selected!&quot;);
    }
}
   /**
* Callback for getSearchRank. Makes ajax request that gets name of previous rank member.   
*
* @class articleRankSuccess
* @constructor
* @param {object} _data Ajax response that contains counts of ranks
*/
function articleRankSuccess(_data){
	getGreekName(this.name,&quot;searchArticle&quot;);
	//Na vriskei kai to onoma tou rank pou prohgeitai tou parontos rank.Sto prohgoumeno rank na lamvanei kai ta onomata ektos apo to count mono
	var values = [&#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;];
  var checkValue = 0;
  //find rank of searched term
  var results = _data.results.bindings[0];
  values[0] = results.countphylum.value;
  values[1] = results.countclass.value;
  values[2] = results.countorder.value;
  values[3] = results.countfamily.value;
  values[4] = results.countgenus.value;
  for (var i in values) {
    if (values[i] != 0) checkValue = values[i];
  }
  
  //Find index of max value, and add 1 to use with rankArray  
  if (checkValue == 0) {
    index = 6; //Search term is species	
  } else {
    maxValue = Math.max.apply(this, values);
    var index = $.inArray(maxValue.toString(), values) + 1;
  }
  
  sessionStorage.setItem(&#x27;rank&#x27;,rankArray[index]);
  if (index&gt;0){
  sessionStorage.setItem(&#x27;prevRank&#x27;,rankArray[index-1]);
  }
	//var searchTerm = $(&#x27;#searchBox&#x27;).val();
        sessionStorage.setItem(&#x27;name&#x27;,this.name)
		
	var query =getprevRankNameQuery(this.name,index);
console.log(query);
   var queryUrl = encodeURI(url + &quot;?query=&quot; + query + &quot;&amp;format=json&quot;);
  $.ajax({
    dataType: &quot;jsonp&quot;,
    url: queryUrl,
    success: prevRankSuccess,
    error: ajaxError
  }); 
	
}
   /**
* Callback for articleRankSuccess. Gets most probable rank name from a list of possible rank names.   
*
* @class  prevRankSuccess
* @constructor
* @param {object} _data Ajax response that contains possible ranks. 
*/
function prevRankSuccess(_data) {
    var results = _data.results.bindings;


    var maxValue = 0;
    var value = &#x27;&#x27;;

    for (var i in results) {
        if (results[i].taxon !== undefined) {

            var count = parseInt(results[i].counttaxon.value);
            if (count &gt; maxValue) {
                maxValue = count;
                var name = nameFromUrl(results[i].taxon.value);
                value = name.replace(&#x27; &#x27;, &quot;_&quot;);
            }

        }
    }

    sessionStorage.setItem(&#x27;prevRankName&#x27;, value);
    window.location.replace(&#x27;article.html&#x27;);
}

/**
* Callback for searchArticle.  
*
* @class searchSuccess
* @constructor
* @param {object} _data Ajax response that contains wikipedia page url
*/
function searchSuccess(_data) {
    var results = _data.query.pages;
    for (var i in results) {}

    if (i &gt; 0) {
   
        getSearchRank(&quot;article&quot;);

    } else {
        $(&#x27;#article&#x27;).html(&quot;Wikipedia article doesn&#x27;t exist&quot;);
    }
}
    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
